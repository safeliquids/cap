<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>cap: Quick Start</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">cap<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Command-line argument parser library for C</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('dd/de4/md_static__docs_2quick__start.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Quick Start</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md11"></a></p>
<h1><a class="anchor" id="autotoc_md12"></a>
Compiling</h1>
<p>The provided <code>Makefile</code> can be used to create a header file called <code>cap.h</code>. </p><div class="fragment"><div class="line"> console</div>
<div class="line">$ make all</div>
<div class="line">gcc -Wall -Wextra -Wformat-security -pedantic -std=c99 -g -I. -o slicer.exe slicer.c</div>
<div class="line">./slicer.exe -o cap.h headers/types.h [... sevaral other file names here...]</div>
</div><!-- fragment --><p> As shown above, this involves building a tool called <code>slicer.exe</code>, the source code of which can be found in the file <code>slicer.c</code> in this repository. The default toolchain to do this is <code>gcc</code>, you can edit the <code>Makefile</code> to use your preferred C compiler.</p>
<h1><a class="anchor" id="autotoc_md13"></a>
Importing <code>cap.h</code> and Creating a Parser</h1>
<p>To use the library, we first include the generated <code>cap.h</code> in the program's main source file. <em>(Note: <code>cap.h</code> must not be included in multiple compilation units. This is a technical limitation caused by it being a single header. In future the library will be changed to consist of one header and one source file which the user can compile to a single object file. This will allow the library to be used in multiple compilation units.)</em> </p><div class="fragment"><div class="line"> c</div>
<div class="line">/* main.c */</div>
<div class="line">#include &quot;cap.h&quot;</div>
<div class="line">...</div>
</div><!-- fragment --><p> Then in the main function, we can create a parser object. </p><div class="fragment"><div class="line"> c</div>
<div class="line">...</div>
<div class="line">int main (int argc, const char ** argv) {</div>
<div class="line">    ArgumentParser * parser = cap_parser_make_default();</div>
<div class="line">    ...</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md14"></a>
Defining Flags</h1>
<p>We can define flags for our program like so </p><div class="fragment"><div class="line">c</div>
<div class="line">   /* inside main() */</div>
<div class="line">   ...</div>
<div class="line">   cap_parser_add_flag(parser, &quot;--big&quot;, DT_DOUBLE, 0, 1, NULL, NULL);</div>
<div class="line">   ...</div>
</div><!-- fragment --><p> The above example creates a flag called "--big" that must be followed by a real number on the command line. That number becomes the value of this flag and is stored as a <code>double</code>, hence the <code>DT_DOUBLE</code>. The two numbers following <code>DT_DOUBLE</code> specify the minimum and maximum number of times this flag is allowed to be on the command line - in this case the flag may be present up to once. We don't need to pay attention to the last two parameters for now.</p>
<p>Flags can not only take <code>double</code> values. We can use <code>DT_INT</code> instead of <code>DT_DOUBLE</code> for integers, or <code>DT_STRING</code> for literal strings. If the flag should take no value, we use a special key <code>DT_PRESENCE</code>.</p>
<p>The maximum number of times a specific flag may be present on the command line (the second number in the example above) must naturally be at least the minimum (the first number). To allow a flag up to any number of times, we can use <code>-1</code> instead of a positive integer, like so. </p><div class="fragment"><div class="line">c</div>
<div class="line">   /* inside main() */</div>
<div class="line">   ...</div>
<div class="line">   cap_parser_add_flag(parser, &quot;-x&quot;, DT_STRING, 0, -1, NULL, NULL);</div>
<div class="line">   ...</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md15"></a>
Defining Positional Arguments</h1>
<p>In addition to flags, positional arguments (or 'positionals') can also be configured for our program. See this example. </p><div class="fragment"><div class="line">c</div>
<div class="line">   /* inside main() */</div>
<div class="line">   ...</div>
<div class="line">   cap_parser_add_positional(</div>
<div class="line">       parser, &quot;filename&quot;, DT_STRING, true, false, NULL, NULL);</div>
<div class="line">   ...</div>
</div><!-- fragment --><p> This call signature should look somewhat familiar - the positional argument's name is "filename" and its value is a string. The two boolean parameters indicate that it is required (<code>true</code>) and that it is not variadic (<code>false</code>). Once again, we don't need to care about the last two arguments for now.</p>
<p>Arguments defined this way are positional, which means they must appear on the command line in the same order as they were defined. In contrast, flags and their values can appear in any order, and may even be mixed inbetween positionals. Since we defined the argument as required and non-variadic, it must be found on the command line when parsing, and takes exactly one value.</p>
<h1><a class="anchor" id="autotoc_md16"></a>
Finally, Parsing</h1>
<p>After we have defined all necessary flags and positionals for our program, we are ready to finally process the words given on the command line </p><div class="fragment"><div class="line">c</div>
<div class="line">   /* inside main() */</div>
<div class="line">   ... </div>
<div class="line">   ParsedArguments * parsed_args = cap_parser_parse(parser, argc, argv);</div>
<div class="line">   ...</div>
</div><!-- fragment --><p> The <code><a class="el" href="../../d0/d0d/group__parsed__arguments.html#d2/d4a/structParsedArguments" title="Stores all information about command line arguments after successful parsing.">ParsedArguments</a></code> contains information about flags and positional that were found on the command line. We can use library functions to get some information from it.</p>
<h1><a class="anchor" id="autotoc_md17"></a>
Accessing Parsed Flags</h1>
<p>For example, to check if a flag has been found on the command line, we can use something like this </p><div class="fragment"><div class="line">c</div>
<div class="line">   /* inside main() */</div>
<div class="line">   ...</div>
<div class="line">   if (cap_pa_has_flag(parsed_args, &quot;-x&quot;)) {</div>
<div class="line">   do_something_because_x_was_given();</div>
<div class="line">   }</div>
<div class="line">   ...</div>
</div><!-- fragment --><p> Before, we defined the "-x" flag so that it may be given any number of times. To check the number of times it was found we can use this </p><div class="fragment"><div class="line">c</div>
<div class="line">   /* inside main() */</div>
<div class="line">   ...</div>
<div class="line">   size_t x_count = cap_pa_flag_count(parsed_args, &quot;-x&quot;);</div>
<div class="line">   ...</div>
</div><!-- fragment --><p>To extract values stored for flags, we use this </p><div class="fragment"><div class="line">c</div>
<div class="line">   /* inside main() */</div>
<div class="line">   ...</div>
<div class="line">   if (!cap_pa_has_flag(parsed_args, &quot;--big&quot;) {</div>
<div class="line">       do_something_when_big_is_absent();</div>
<div class="line">   exit(-1);</div>
<div class="line">   }</div>
<div class="line">   </div>
<div class="line">   const TypedUnion * big_value = cap_pa_get_flag(parsed_args, &quot;--big&quot;);</div>
<div class="line">   ...</div>
</div><!-- fragment --><p> As the type name suggests, this function returns an object that contains a value and information about that value's type. We have previously defined the "--big" flag to take a real number for a value. Although the parser should never store an incorrect type, we can check if the value stored in <code>parsed_args</code> is indeed a <code>DT_DOUBLE</code> </p><div class="fragment"><div class="line">c</div>
<div class="line">   /* inside main() */</div>
<div class="line">   ...</div>
<div class="line">   if (!cap_tu_is_double(big_value)) {</div>
<div class="line">       printf(&quot;oh no, it was not double!\n&quot;);</div>
<div class="line">   exit(-1);</div>
<div class="line">   }</div>
</div><!-- fragment --><p> To extract the actual number from <code>big_value</code>, we can do this </p><div class="fragment"><div class="line">c</div>
<div class="line">   /* inside main() */</div>
<div class="line">   ...</div>
<div class="line">   double big_number = cap_tu_as_double(big_value);</div>
<div class="line">   ...</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md18"></a>
Accessing Parsed Positionals</h1>
<p>In a similar fashion, we can query if <code>parsed_args</code> contains a positional argument. </p><div class="fragment"><div class="line">c</div>
<div class="line">   /* inside main() */</div>
<div class="line">   ...</div>
<div class="line">   if (!cap_pa_has_positional(parsed_args, &quot;filename&quot;)) {</div>
<div class="line">       do_something_because_no_filename();</div>
<div class="line">   exit(-1);</div>
<div class="line">   }</div>
<div class="line">   ...</div>
</div><!-- fragment --><p> Other operations regarding positionals are also quite similar. </p><div class="fragment"><div class="line">c</div>
<div class="line">   /* inside main() */</div>
<div class="line">   ...</div>
<div class="line">   const TypedUnion * fil = cap_pa_get_positional(parsed_args, &quot;filename&quot;);</div>
<div class="line">   const char * filename = cap_tu_as_string(fil);</div>
<div class="line">   ...</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md19"></a>
Errors</h1>
<p>Most errors related to the parser cause the program to exit with an error message. For example, when trying to create a flag that does not start with a flag prefix character ('-' by default), it may result in something like </p><div class="fragment"><div class="line"> console</div>
<div class="line">$ ./myprogram</div>
<div class="line">cap: invalid flag name - must begin with one of &quot;-&quot;</div>
</div><!-- fragment --><p> Similar messages will appear for other errors connected to configuring a parser.</p>
<p>Another kind of error can happen at parse time. These will also crash the program. For example, unknown flags wil cause something like </p><div class="fragment"><div class="line"> console</div>
<div class="line">$ ./myprogram -P</div>
<div class="line">myprogram: unknown flag &#39;-P&#39;</div>
<div class="line"> </div>
<div class="line">usage:</div>
<div class="line">        myprogram [-h] [--big DOUBLE] [-x STRING] [--] &lt;filename&gt;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md20"></a>
I Don't Want to Play With You Any More!</h1>
<p>Once a parser object is no longer needed, it can be deleted using the function <code>cap_parser_destroy</code>. Any <code><a class="el" href="../../d0/d0d/group__parsed__arguments.html#d2/d4a/structParsedArguments" title="Stores all information about command line arguments after successful parsing.">ParsedArguments</a></code> object returned from <code>cap_parser_parse</code> should be deleted using <code>cap_pa_destroy</code>. Values retrieved from a <code><a class="el" href="../../d0/d0d/group__parsed__arguments.html#d2/d4a/structParsedArguments" title="Stores all information about command line arguments after successful parsing.">ParsedArguments</a></code> (such as using <code>cap_pa_get_flag</code>) are still owned by that object. That way they do not need to be deleted by the user, however, they <em>must not</em> be used after the <code><a class="el" href="../../d0/d0d/group__parsed__arguments.html#d2/d4a/structParsedArguments" title="Stores all information about command line arguments after successful parsing.">ParsedArguments</a></code> is deleted. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
